---

title: Dummy Experiment Manager


keywords: fastai
sidebar: home_sidebar

summary: "Dummy experiment manager"
description: "Dummy experiment manager"
nb_path: "nbs/examples/dummy_experiment_manager.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs/examples/dummy_experiment_manager.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>/anaconda/envs/athena_gpu/lib/python3.7/site-packages/sklearn/utils/deprecation.py:144: FutureWarning: The sklearn.datasets.base module is  deprecated in version 0.22 and will be removed in version 0.24. The corresponding classes / functions should instead be imported from sklearn.datasets. Anything that cannot be imported from sklearn.datasets is now part of the private API.
  warnings.warn(message, FutureWarning)
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>0.1385026334992035</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="FakeModel" class="doc_header"><code>class</code> <code>FakeModel</code><a href="https://github.com/Jaume-JCI/hpsearch/tree/master/hpsearch/examples/dummy_experiment_manager.py#L8" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>FakeModel</code>(<strong><code>offset</code></strong>=<em><code>0.5</code></em>, <strong><code>rate</code></strong>=<em><code>0.01</code></em>, <strong><code>epochs</code></strong>=<em><code>10</code></em>, <strong><code>noise</code></strong>=<em><code>0.0</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="DummyExperimentManager" class="doc_header"><code>class</code> <code>DummyExperimentManager</code><a href="https://github.com/Jaume-JCI/hpsearch/tree/master/hpsearch/examples/dummy_experiment_manager.py#L65" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>DummyExperimentManager</code>() :: <a href="/hpsearch/experiment_manager.html#ExperimentManager"><code>ExperimentManager</code></a></p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Example-use">Example use<a class="anchor-link" href="#Example-use"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="run_multiple_experiments" class="doc_header"><code>run_multiple_experiments</code><a href="https://github.com/Jaume-JCI/hpsearch/tree/master/hpsearch/examples/dummy_experiment_manager.py#L116" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>run_multiple_experiments</code>(<strong><code>nruns</code></strong>=<em><code>1</code></em>, <strong><code>noise</code></strong>=<em><code>0.0</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="remove_previous_experiments" class="doc_header"><code>remove_previous_experiments</code><a href="https://github.com/Jaume-JCI/hpsearch/tree/master/hpsearch/examples/dummy_experiment_manager.py#L132" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>remove_previous_experiments</code>()</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">remove_previous_experiments</span><span class="p">()</span>
<span class="n">run_multiple_experiments</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>experiment script: &lt;ipython-input-6-040d6836191d&gt;, line: 11
processing hyper-parameter 0 out of 9
doing run 0 out of 1
fixed rate, multiple epochs values
returning registered experiment manager
returning experiment manager &lt;__main__.DummyExperimentManager object at 0x7f295c2fc150&gt;
running experiment 0
run number: 0

parameters:
	epochs=5,
	offset=0.1,
	rate=0.03

script: &lt;ipython-input-6-040d6836191d&gt;, line number: 11
time spent on this experiment: 0.0003249645233154297
0 - validation_accuracy: 0.25
0 - test_accuracy: 0.35
finished experiment 0
processing hyper-parameter 1 out of 9
doing run 0 out of 1
fixed rate, multiple epochs values
running experiment 1
run number: 0

parameters:
	epochs=5,
	offset=0.3,
	rate=0.03

script: &lt;ipython-input-6-040d6836191d&gt;, line number: 11
time spent on this experiment: 0.0002732276916503906
0 - validation_accuracy: 0.45000000000000007
0 - test_accuracy: 0.55
finished experiment 1
processing hyper-parameter 2 out of 9
doing run 0 out of 1
fixed rate, multiple epochs values
running experiment 2
run number: 0

parameters:
	epochs=5,
	offset=0.6,
	rate=0.03

script: &lt;ipython-input-6-040d6836191d&gt;, line number: 11
time spent on this experiment: 0.00019669532775878906
0 - validation_accuracy: 0.7500000000000001
0 - test_accuracy: 0.8500000000000001
finished experiment 2
processing hyper-parameter 3 out of 9
doing run 0 out of 1
fixed rate, multiple epochs values
running experiment 3
run number: 0

parameters:
	epochs=15,
	offset=0.1,
	rate=0.03

script: &lt;ipython-input-6-040d6836191d&gt;, line number: 11
time spent on this experiment: 0.000518798828125
0 - validation_accuracy: 0.5500000000000003
0 - test_accuracy: 0.4500000000000003
finished experiment 3
processing hyper-parameter 4 out of 9
doing run 0 out of 1
fixed rate, multiple epochs values
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>write_manager failed with exception &lt;class &#39;__main__.DummyExperimentManager&#39;&gt; is a built-in class
fitting model with 5 epochs
epoch 0: accuracy: 0.13
epoch 1: accuracy: 0.16
epoch 2: accuracy: 0.19
epoch 3: accuracy: 0.22
epoch 4: accuracy: 0.25
noise: 0.0
write_manager failed with exception &lt;class &#39;__main__.DummyExperimentManager&#39;&gt; is a built-in class
fitting model with 5 epochs
epoch 0: accuracy: 0.32999999999999996
epoch 1: accuracy: 0.36
epoch 2: accuracy: 0.39
epoch 3: accuracy: 0.42000000000000004
epoch 4: accuracy: 0.45000000000000007
noise: 0.0
write_manager failed with exception &lt;class &#39;__main__.DummyExperimentManager&#39;&gt; is a built-in class
fitting model with 5 epochs
epoch 0: accuracy: 0.63
epoch 1: accuracy: 0.66
epoch 2: accuracy: 0.6900000000000001
epoch 3: accuracy: 0.7200000000000001
epoch 4: accuracy: 0.7500000000000001
noise: 0.0
write_manager failed with exception &lt;class &#39;__main__.DummyExperimentManager&#39;&gt; is a built-in class
fitting model with 15 epochs
epoch 0: accuracy: 0.13
epoch 1: accuracy: 0.16
epoch 2: accuracy: 0.19
epoch 3: accuracy: 0.22
epoch 4: accuracy: 0.25
epoch 5: accuracy: 0.28
epoch 6: accuracy: 0.31000000000000005
epoch 7: accuracy: 0.3400000000000001
epoch 8: accuracy: 0.3700000000000001
epoch 9: accuracy: 0.40000000000000013
epoch 10: accuracy: 0.43000000000000016
epoch 11: accuracy: 0.4600000000000002
epoch 12: accuracy: 0.4900000000000002
epoch 13: accuracy: 0.5200000000000002
epoch 14: accuracy: 0.5500000000000003
noise: 0.0
write_manager failed with exception &lt;class &#39;__main__.DummyExperimentManager&#39;&gt; is a built-in class
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>running experiment 4
run number: 0

parameters:
	epochs=15,
	offset=0.3,
	rate=0.03

script: &lt;ipython-input-6-040d6836191d&gt;, line number: 11
time spent on this experiment: 0.0005366802215576172
0 - validation_accuracy: 0.7500000000000003
0 - test_accuracy: 0.6500000000000004
finished experiment 4
processing hyper-parameter 5 out of 9
doing run 0 out of 1
fixed rate, multiple epochs values
running experiment 5
run number: 0

parameters:
	epochs=15,
	offset=0.6,
	rate=0.03

script: &lt;ipython-input-6-040d6836191d&gt;, line number: 11
time spent on this experiment: 0.0006055831909179688
0 - validation_accuracy: 1.0
0 - test_accuracy: 0.9500000000000003
finished experiment 5
processing hyper-parameter 6 out of 9
doing run 0 out of 1
fixed rate, multiple epochs values
running experiment 6
run number: 0

parameters:
	epochs=30,
	offset=0.1,
	rate=0.03

script: &lt;ipython-input-6-040d6836191d&gt;, line number: 11
time spent on this experiment: 0.0015568733215332031
0 - validation_accuracy: 0.40000000000000013
0 - test_accuracy: 0.30000000000000016
finished experiment 6
processing hyper-parameter 7 out of 9
doing run 0 out of 1
fixed rate, multiple epochs values
running experiment 7
run number: 0

parameters:
	epochs=30,
	offset=0.3,
	rate=0.03

script: &lt;ipython-input-6-040d6836191d&gt;, line number: 11
time spent on this experiment: 0.0008528232574462891
0 - validation_accuracy: 0.6000000000000002
0 - test_accuracy: 0.5000000000000002
finished experiment 7
processing hyper-parameter 8 out of 9
doing run 0 out of 1
fixed rate, multiple epochs values
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>fitting model with 15 epochs
epoch 0: accuracy: 0.32999999999999996
epoch 1: accuracy: 0.36
epoch 2: accuracy: 0.39
epoch 3: accuracy: 0.42000000000000004
epoch 4: accuracy: 0.45000000000000007
epoch 5: accuracy: 0.4800000000000001
epoch 6: accuracy: 0.5100000000000001
epoch 7: accuracy: 0.5400000000000001
epoch 8: accuracy: 0.5700000000000002
epoch 9: accuracy: 0.6000000000000002
epoch 10: accuracy: 0.6300000000000002
epoch 11: accuracy: 0.6600000000000003
epoch 12: accuracy: 0.6900000000000003
epoch 13: accuracy: 0.7200000000000003
epoch 14: accuracy: 0.7500000000000003
noise: 0.0
write_manager failed with exception &lt;class &#39;__main__.DummyExperimentManager&#39;&gt; is a built-in class
fitting model with 15 epochs
epoch 0: accuracy: 0.63
epoch 1: accuracy: 0.66
epoch 2: accuracy: 0.6900000000000001
epoch 3: accuracy: 0.7200000000000001
epoch 4: accuracy: 0.7500000000000001
epoch 5: accuracy: 0.7800000000000001
epoch 6: accuracy: 0.8100000000000002
epoch 7: accuracy: 0.8400000000000002
epoch 8: accuracy: 0.8700000000000002
epoch 9: accuracy: 0.9000000000000002
epoch 10: accuracy: 0.9300000000000003
epoch 11: accuracy: 0.9600000000000003
epoch 12: accuracy: 0.9900000000000003
epoch 13: accuracy: 1.0200000000000002
epoch 14: accuracy: 1.0500000000000003
noise: 0.0
write_manager failed with exception &lt;class &#39;__main__.DummyExperimentManager&#39;&gt; is a built-in class
fitting model with 30 epochs
epoch 0: accuracy: 0.13
epoch 1: accuracy: 0.16
epoch 2: accuracy: 0.19
epoch 3: accuracy: 0.22
epoch 4: accuracy: 0.25
epoch 5: accuracy: 0.28
epoch 6: accuracy: 0.31000000000000005
epoch 7: accuracy: 0.3400000000000001
epoch 8: accuracy: 0.3700000000000001
epoch 9: accuracy: 0.40000000000000013
epoch 10: accuracy: 0.43000000000000016
epoch 11: accuracy: 0.4600000000000002
epoch 12: accuracy: 0.4900000000000002
epoch 13: accuracy: 0.5200000000000002
epoch 14: accuracy: 0.5500000000000003
epoch 15: accuracy: 0.5800000000000003
epoch 16: accuracy: 0.6100000000000003
epoch 17: accuracy: 0.6400000000000003
epoch 18: accuracy: 0.6700000000000004
epoch 19: accuracy: 0.7000000000000004
epoch 20: accuracy: 0.6700000000000004
epoch 21: accuracy: 0.6400000000000003
epoch 22: accuracy: 0.6100000000000003
epoch 23: accuracy: 0.5800000000000003
epoch 24: accuracy: 0.5500000000000003
epoch 25: accuracy: 0.5200000000000002
epoch 26: accuracy: 0.4900000000000002
epoch 27: accuracy: 0.4600000000000002
epoch 28: accuracy: 0.43000000000000016
epoch 29: accuracy: 0.40000000000000013
noise: 0.0
write_manager failed with exception &lt;class &#39;__main__.DummyExperimentManager&#39;&gt; is a built-in class
fitting model with 30 epochs
epoch 0: accuracy: 0.32999999999999996
epoch 1: accuracy: 0.36
epoch 2: accuracy: 0.39
epoch 3: accuracy: 0.42000000000000004
epoch 4: accuracy: 0.45000000000000007
epoch 5: accuracy: 0.4800000000000001
epoch 6: accuracy: 0.5100000000000001
epoch 7: accuracy: 0.5400000000000001
epoch 8: accuracy: 0.5700000000000002
epoch 9: accuracy: 0.6000000000000002
epoch 10: accuracy: 0.6300000000000002
epoch 11: accuracy: 0.6600000000000003
epoch 12: accuracy: 0.6900000000000003
epoch 13: accuracy: 0.7200000000000003
epoch 14: accuracy: 0.7500000000000003
epoch 15: accuracy: 0.7800000000000004
epoch 16: accuracy: 0.8100000000000004
epoch 17: accuracy: 0.8400000000000004
epoch 18: accuracy: 0.8700000000000004
epoch 19: accuracy: 0.9000000000000005
epoch 20: accuracy: 0.8700000000000004
epoch 21: accuracy: 0.8400000000000004
epoch 22: accuracy: 0.8100000000000004
epoch 23: accuracy: 0.7800000000000004
epoch 24: accuracy: 0.7500000000000003
epoch 25: accuracy: 0.7200000000000003
epoch 26: accuracy: 0.6900000000000003
epoch 27: accuracy: 0.6600000000000003
epoch 28: accuracy: 0.6300000000000002
epoch 29: accuracy: 0.6000000000000002
noise: 0.0
write_manager failed with exception &lt;class &#39;__main__.DummyExperimentManager&#39;&gt; is a built-in class
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stderr output_text">
<pre>running experiment 8
run number: 0

parameters:
	epochs=30,
	offset=0.6,
	rate=0.03

script: &lt;ipython-input-6-040d6836191d&gt;, line number: 11
time spent on this experiment: 0.001252889633178711
0 - validation_accuracy: 0.9000000000000001
0 - test_accuracy: 0.8000000000000002
finished experiment 8
</pre>
</div>
</div>

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>fitting model with 30 epochs
epoch 0: accuracy: 0.63
epoch 1: accuracy: 0.66
epoch 2: accuracy: 0.6900000000000001
epoch 3: accuracy: 0.7200000000000001
epoch 4: accuracy: 0.7500000000000001
epoch 5: accuracy: 0.7800000000000001
epoch 6: accuracy: 0.8100000000000002
epoch 7: accuracy: 0.8400000000000002
epoch 8: accuracy: 0.8700000000000002
epoch 9: accuracy: 0.9000000000000002
epoch 10: accuracy: 0.9300000000000003
epoch 11: accuracy: 0.9600000000000003
epoch 12: accuracy: 0.9900000000000003
epoch 13: accuracy: 1.0200000000000002
epoch 14: accuracy: 1.0500000000000003
epoch 15: accuracy: 1.0800000000000003
epoch 16: accuracy: 1.1100000000000003
epoch 17: accuracy: 1.1400000000000003
epoch 18: accuracy: 1.1700000000000004
epoch 19: accuracy: 1.2000000000000004
epoch 20: accuracy: 1.1700000000000004
epoch 21: accuracy: 1.1400000000000003
epoch 22: accuracy: 1.1100000000000003
epoch 23: accuracy: 1.0800000000000003
epoch 24: accuracy: 1.0500000000000003
epoch 25: accuracy: 1.0200000000000002
epoch 26: accuracy: 0.9900000000000002
epoch 27: accuracy: 0.9600000000000002
epoch 28: accuracy: 0.9300000000000002
epoch 29: accuracy: 0.9000000000000001
noise: 0.0
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">em</span> <span class="o">=</span> <span class="n">DummyExperimentManager</span> <span class="p">()</span>
<span class="n">path_results</span> <span class="o">=</span> <span class="n">em</span><span class="o">.</span><span class="n">get_path_experiments</span><span class="p">()</span>
<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span> <span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{path_results}</span><span class="s1">/experiments_data.csv&#39;</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">df</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>epochs</th>
      <th>offset</th>
      <th>rate</th>
      <th>0_validation_accuracy</th>
      <th>0_test_accuracy</th>
      <th>time_0</th>
      <th>date</th>
      <th>0_finished</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>5.0</td>
      <td>0.1</td>
      <td>0.03</td>
      <td>0.25</td>
      <td>0.35</td>
      <td>0.001436</td>
      <td>16:21:10.322625</td>
      <td>True</td>
    </tr>
    <tr>
      <th>1</th>
      <td>5.0</td>
      <td>0.3</td>
      <td>0.03</td>
      <td>0.45</td>
      <td>0.55</td>
      <td>0.000821</td>
      <td>16:21:10.365310</td>
      <td>True</td>
    </tr>
    <tr>
      <th>2</th>
      <td>5.0</td>
      <td>0.6</td>
      <td>0.03</td>
      <td>0.75</td>
      <td>0.85</td>
      <td>0.000762</td>
      <td>16:21:10.410164</td>
      <td>True</td>
    </tr>
    <tr>
      <th>3</th>
      <td>15.0</td>
      <td>0.1</td>
      <td>0.03</td>
      <td>0.55</td>
      <td>0.45</td>
      <td>0.001040</td>
      <td>16:21:10.460884</td>
      <td>True</td>
    </tr>
    <tr>
      <th>4</th>
      <td>15.0</td>
      <td>0.3</td>
      <td>0.03</td>
      <td>0.75</td>
      <td>0.65</td>
      <td>0.002967</td>
      <td>16:21:10.512993</td>
      <td>True</td>
    </tr>
    <tr>
      <th>5</th>
      <td>15.0</td>
      <td>0.6</td>
      <td>0.03</td>
      <td>1.00</td>
      <td>0.95</td>
      <td>0.001114</td>
      <td>16:21:10.562620</td>
      <td>True</td>
    </tr>
    <tr>
      <th>6</th>
      <td>30.0</td>
      <td>0.1</td>
      <td>0.03</td>
      <td>0.40</td>
      <td>0.30</td>
      <td>0.002101</td>
      <td>16:21:10.619440</td>
      <td>True</td>
    </tr>
    <tr>
      <th>7</th>
      <td>30.0</td>
      <td>0.3</td>
      <td>0.03</td>
      <td>0.60</td>
      <td>0.50</td>
      <td>0.001428</td>
      <td>16:21:10.675769</td>
      <td>True</td>
    </tr>
    <tr>
      <th>8</th>
      <td>30.0</td>
      <td>0.6</td>
      <td>0.03</td>
      <td>0.90</td>
      <td>0.80</td>
      <td>0.001867</td>
      <td>16:21:10.734334</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># check that stored parameters are correct</span>
<span class="k">assert</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">epochs</span><span class="o">.</span><span class="n">values</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span> <span class="mf">5.</span><span class="p">,</span>  <span class="mf">5.</span><span class="p">,</span>  <span class="mf">5.</span><span class="p">,</span> <span class="mf">15.</span><span class="p">,</span> <span class="mf">15.</span><span class="p">,</span> <span class="mf">15.</span><span class="p">,</span> <span class="mf">30.</span><span class="p">,</span> <span class="mf">30.</span><span class="p">,</span> <span class="mf">30.</span><span class="p">]))</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="k">assert</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">offset</span><span class="o">.</span><span class="n">values</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]))</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
<span class="k">assert</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">rate</span><span class="o">.</span><span class="n">values</span> <span class="o">==</span> <span class="mf">0.03</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">epochs_before_overfitting</span> <span class="o">=</span> <span class="mi">20</span>
<span class="n">epochs_test</span> <span class="o">=</span> <span class="mi">10</span>
<span class="k">for</span> <span class="n">experiment_id</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">:</span>
    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">experiment_id</span><span class="p">,</span> <span class="s1">&#39;epochs&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">epochs_before_overfitting</span><span class="p">:</span>
        <span class="n">accuracy</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">experiment_id</span><span class="p">,</span> <span class="s1">&#39;offset&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">experiment_id</span><span class="p">,</span> <span class="s1">&#39;rate&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">experiment_id</span><span class="p">,</span> <span class="s1">&#39;epochs&#39;</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">epochs_after_overfitting</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">experiment_id</span><span class="p">,</span> <span class="s1">&#39;epochs&#39;</span><span class="p">]</span><span class="o">-</span><span class="n">epochs_before_overfitting</span>
        <span class="n">accuracy</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">experiment_id</span><span class="p">,</span> <span class="s1">&#39;offset&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">experiment_id</span><span class="p">,</span> <span class="s1">&#39;rate&#39;</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">epochs_before_overfitting</span>  <span class="o">-</span> <span class="n">epochs_after_overfitting</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">experiment_id</span><span class="p">,</span> <span class="s1">&#39;epochs&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">epochs_test</span><span class="p">:</span>
        <span class="n">test_accuracy</span> <span class="o">=</span> <span class="n">accuracy</span> <span class="o">+</span> <span class="mf">0.1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">test_accuracy</span> <span class="o">=</span> <span class="n">accuracy</span> <span class="o">-</span> <span class="mf">0.1</span>
    <span class="n">validation_accuracy</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">accuracy</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">)</span>
    <span class="n">test_accuracy</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">test_accuracy</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">),</span> <span class="mf">0.0</span><span class="p">)</span>
    
    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">experiment_id</span><span class="p">,</span> <span class="s1">&#39;0_validation_accuracy&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">validation_accuracy</span><span class="p">)</span> <span class="o">&lt;</span><span class="mf">1.e-10</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;experiment </span><span class="si">{experiment_id}</span><span class="s2">: </span><span class="si">{df.loc[experiment_id, &#39;0_validation_accuracy&#39;]}</span><span class="s2"> == </span><span class="si">{validation_accuracy}</span><span class="s2">&quot;</span> 
    <span class="k">assert</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">experiment_id</span><span class="p">,</span> <span class="s1">&#39;0_test_accuracy&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">test_accuracy</span><span class="p">)</span> <span class="o">&lt;</span><span class="mf">1.e-10</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

</div>
 

